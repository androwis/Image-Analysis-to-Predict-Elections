/*
Copyright 2011 Frederic Langlet
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
you may obtain a copy of the License at

                http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

package kanzi.test;

import java.util.Random;
import kanzi.transform.BWT;


public class TestBWT
{
    private static final byte[] ARRAY1 = new byte[]
{
 80, 75, 3, 4, 10, 0, 0, 0, 0, 0, 77, 14, 44, 57, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 
 0, 0, 0, 77, 69, 84, 65, 45, 73, 78, 70, 47, 80, 75, 3, 4, 10, 0, 0, 0, 0, 0, 77, 14, 44, 
 57, -122, 117, -9, 18, 55, 9, 0, 0, 55, 9, 0, 0, 20, 0, 0, 0, 77, 69, 84, 65, 45, 73, 78, 
 70, 47, 77, 65, 78, 73, 70, 69, 83, 84, 46, 77, 70, 77, 97, 110, 105, 102, 101, 115, 116, 
 45, 86, 101, 114, 115, 105, 111, 110, 58, 32, 49, 46, 48, 13, 10, 73, 109, 112, 108, 101, 
 109, 101, 110, 116, 97, 116, 105, 111, 110, 45, 86, 101, 110, 100, 111, 114, 58, 32, 83, 
 117, 110, 32, 77, 105, 99, 114, 111, 115, 121, 115, 116, 101, 109, 115, 44, 32, 73, 110,
 99, 46, 13, 10, 73, 109, 112, 108, 101, 109, 101, 110, 116, 97, 116, 105, 111, 110, 45, 84, 
 105, 116, 108, 101, 58, 32, 74, 97, 118, 97, 32, 82, 117, 110, 116, 105, 109, 101, 32, 69, 
 110, 118, 105, 114, 111, 110, 109, 101, 110, 116, 13, 10, 73, 109, 112, 108, 101, 109, 101, 
 110, 116, 97, 116, 105, 111, 110, 45, 86, 101, 114, 115, 105, 111, 110, 58, 32, 49, 46, 54, 
 46, 48, 95, 49, 48, 45, 114, 99, 50, 13, 10, 83, 112, 101, 99, 105, 102, 105, 99, 97, 116, 
 105, 111, 110, 45, 86, 101, 110, 100, 111, 114, 58, 32, 83, 117, 110, 32, 77, 105, 99, 114, 
 111, 115, 121, 115, 116, 101, 109, 115, 44, 32, 73, 110, 99, 46, 13, 10, 67, 114, 101, 97, 
 116, 101, 100, 45, 66, 121, 58, 32, 49, 46, 54, 46, 48, 95, 49, 48, 45, 114, 99, 50, 32, 40, 
 83, 117, 110, 32, 77, 105, 99, 114, 111, 115, 121, 115, 116, 101, 109, 115, 32, 73, 110, 99, 
 46, 41, 13, 10, 83, 112, 101, 99, 105, 102, 105, 99, 97, 116, 105, 111, 110, 45, 84, 105, 116, 
 108, 101, 58, 32, 74, 97, 118, 97, 32, 80, 108, 97, 116, 102, 111, 114, 109, 32, 65, 80, 73, 32, 
 83, 112, 101, 99, 105, 102, 105, 99, 97, 116, 105, 111, 110, 13, 10, 83, 112, 101, 99, 105, 102, 
 105, 99, 97, 116, 105, 111, 110, 45, 86, 101, 114, 115, 105, 111, 110, 58, 32, 49, 46, 54, 13, 10, 
 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 67, 
 104, 101, 99, 107, 66, 111, 120, 77, 101, 110, 117, 73, 116, 101, 109, 46, 99, 108, 97, 115, 115, 
 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97,
 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 68, 105, 97, 108, 111, 
 103, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 
 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 
 47, 74, 83, 108, 105, 100, 101, 114, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 
 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 
 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 84, 101, 120, 116, 70, 105, 101, 108, 100, 46, 99, 
 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 
 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 
 74, 84, 101, 120, 116, 80, 97, 110, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 
 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 
 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 84, 101, 120, 116, 65, 114, 101, 97, 46, 99, 
 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 
 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 
 74, 76, 105, 115, 116, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 
 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 
 120, 47, 115, 119, 105, 110, 103, 47, 74, 70, 111, 114, 109, 97, 116, 116, 101, 100, 84, 101, 
 120, 116, 70, 105, 101, 108, 100, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 
 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 
 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 65, 112, 112, 108, 101, 116, 46, 99, 108, 97, 115, 
 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 
 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 83, 112, 105, 
 110, 110, 101, 114, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 
 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 
 115, 119, 105, 110, 103, 47, 74, 76, 97, 98, 101, 108, 46, 99, 108, 97, 115, 115, 13, 10, 74, 
 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 
 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 83, 112, 108, 105, 116, 80, 
 97, 110, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 
 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 
 105, 110, 103, 47, 74, 83, 101, 112, 97, 114, 97, 116, 111, 114, 46, 99, 108, 97, 115, 115, 13, 
 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 
 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 67, 111, 109, 98, 
 111, 66, 111, 120, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 
 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 
 47, 115, 119, 105, 110, 103, 47, 74, 77, 101, 110, 117, 73, 116, 101, 109, 46, 99, 108, 97, 
 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 
 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 
 74, 83, 99, 114, 111, 108, 108, 66, 97, 114, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 
 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 
 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 67, 104, 101, 99, 107, 66, 
 111, 120, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 
 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 
 119, 105, 110, 103, 47, 74, 84, 97, 98, 98, 101, 100, 80, 97, 110, 101, 46, 99, 108, 97, 115, 
 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 
 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 
 84, 97, 98, 108, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 
 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 
 120, 47, 115, 119, 105, 110, 103, 47, 74, 69, 100, 105, 116, 111, 114, 80, 97, 110, 101, 46, 
 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 
 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 
 103, 47, 74, 80, 114, 111, 103, 114, 101, 115, 115, 66, 97, 114, 46, 99, 108, 97, 115, 115, 
 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 
 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 66, 117, 116, 
 116, 111, 110, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 
 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 
 105, 110, 103, 47, 74, 80, 111, 112, 117, 112, 77, 101, 110, 117, 46, 99, 108, 97, 115, 115, 13, 
 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 
 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 82, 97, 100, 105, 111, 66, 
 117, 116, 116, 111, 110, 77, 101, 110, 117, 73, 116, 101, 109, 46, 99, 108, 97, 115, 115, 13, 10, 74, 
 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 
 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 77, 101, 110, 117, 66, 97, 114, 46, 
 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 
 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 84, 
 111, 103, 103, 108, 101, 66, 117, 116, 116, 111, 110, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 
 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 
 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 87, 105, 110, 100, 111, 119, 46, 99, 108, 97, 115, 
 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 
 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 73, 110, 116, 101, 114, 
 110, 97, 108, 70, 114, 97, 109, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 
 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 
 47, 115, 119, 105, 110, 103, 47, 74, 80, 97, 110, 101, 108, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 
 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 
 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 84, 111, 111, 108, 66, 97, 114, 46, 99, 
 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 
 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 70, 
 114, 97, 109, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 
 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 
 110, 103, 47, 74, 83, 99, 114, 111, 108, 108, 80, 97, 110, 101, 46, 99, 108, 97, 115, 115, 13, 10, 74, 
 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 
 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 84, 114, 101, 101, 46, 99, 108, 97, 
 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 
 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 77, 101, 110, 
 117, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 
 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 
 47, 74, 80, 97, 115, 115, 119, 111, 114, 100, 70, 105, 101, 108, 100, 46, 99, 108, 97, 115, 115, 13, 
 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 
 101, 58, 32, 106, 97, 118, 97, 120, 47, 115, 119, 105, 110, 103, 47, 74, 82, 97, 100, 105, 111, 66, 
 117, 116, 116, 111, 110, 46, 99, 108, 97, 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 
 58, 32, 84, 114, 117, 101, 13, 10, 13, 10, 78, 97, 109, 101, 58, 32, 106, 97, 118, 97, 120, 47, 
 115, 119, 105, 110, 103, 47, 74, 79, 112, 116, 105, 111, 110, 80, 97, 110, 101, 46, 99, 108, 97, 
 115, 115, 13, 10, 74, 97, 118, 97, 45, 66, 101, 97, 110, 58, 32, 84, 114, 117, 101, 13, 10, 13, 
 10, 80, 75, 3, 4, 10, 0, 0, 0, 0, 0, 52, 9, 44, 57, -60, -28, -66, -8, -32, 16, 0, 0, -32, 16, 
 0, 0, 60, 0, 0, 0, 99, 111, 109, 47, 115, 117, 110, 47, 97, 99, 99, 101, 115, 115, 105, 98, 105, 
 108, 105, 116, 121, 47, 105, 110, 116, 101, 114, 110, 97, 108, 47, 114, 101, 115, 111, 117, 114, 
 99, 101, 115, 47, 97, 99, 99, 101, 115, 115, 105, 98, 105, 108, 105, 116, 121, 46, 99, 108, 97, 
 115, 115, -54, -2, -70, -66, 0, 0, 0, 49, 1, 50, 8, 0, -108, 8, 0, -106, 8, 0, -104, 8, 0, -103, 
 8, 0, -102, 8, 0, -101, 8, 0, -100, 8, 0, -99, 8, 0, -98, 8, 0, -97, 8, 0, -96, 8, 0, -95, 8, 0, 
 -94, 8, 0, -93, 8, 0, -92, 8, 0, -91, 8, 0, -90, 8, 0, -89, 8, 0, -87, 8, 0, -86, 8, 0, -85, 8, 
 0, -84, 8, 0, -83, 8, 0, -82, 8, 0, -81, 8, 0, -80, 8, 0, -79, 8, 0, -78, 8, 0, -77, 8, 0, -76, 
 8, 0, -75, 8, 0, -74, 8, 0, -73, 8, 0, -72, 8, 0, -71, 8, 0, -70, 8, 0, -69, 8, 0, -68, 8, 0, -67, 
 8, 0, -66, 8, 0, -65, 8, 0, -64, 8, 0, -63, 8, 0, -62, 8, 0, -61, 8, 0, -60, 8, 0, -59, 8, 0, -58, 
 8, 0, -57, 8, 0, -55, 8, 0, -54, 8, 0, -53, 8, 0, -52, 8, 0, -51, 8, 0, -50, 8, 0, -49, 8, 0, -48, 
 8, 0, -47, 8, 0, -44, 8, 0, -43, 8, 0, -42, 8, 0, -41, 8, 0, -40, 8, 0, -39, 8, 0, -38, 8, 0, -37, 
 8, 0, -36, 8, 0, -35, 8, 0, -34, 8, 0, -33, 8, 0, -32, 8, 0, -31, 8, 0, -30, 8, 0, -29, 8, 0, -28, 
 8, 0, -27, 8, 0, -26, 8, 0, -25, 8, 0, -24, 8, 0, -23, 8, 0, -22, 8, 0, -21, 8, 0, -20, 8, 0, -19, 
 8, 0, -18, 8, 0, -17, 8, 0, -16, 8, 0, -15, 8, 0, -14, 8, 0, -13, 8, 0, -12, 8, 0, -11, 8, 0, -10, 
 8, 0, -9, 8, 0, -8, 8, 0, -7, 8, 0, -6, 8, 0, -5, 8, 0, -4, 8, 0, -3, 8, 0, -2, 8, 0, -1, 8, 1, 0, 
 8, 1, 1, 8, 1, 2, 8, 1, 3, 8, 1, 4, 8, 1, 5, 8, 1, 6, 8, 1, 7, 8, 1, 8, 8, 1, 9, 8, 1, 10, 8, 1, 11, 
 8, 1, 12, 8, 1, 13, 8, 1, 14, 8, 1, 15, 8, 1, 16, 8, 1, 17, 8, 1, 18, 8, 1, 19, 8, 1, 20, 8, 1, 21, 
 8, 1, 22, 8, 1, 23, 8, 1, 24, 8, 1, 25, 8, 1, 26, 8, 1, 27, 8, 1, 28, 8, 1, 29, 8, 1, 30, 8, 1, 31, 
 8, 1, 32, 8, 1, 33, 8, 1, 34, 8, 1, 35, 8, 1, 36, 8, 1, 37, 8, 1, 38, 8, 1, 39, 8, 1, 40, 8, 1, 41, 
 8, 1, 42, 1, 0, 3, 40, 41, 86, 1, 0, 6, 60, 105, 110, 105, 116, 62, 1, 0, 13, 65, 87, 84, 32, 99, 
 111, 109, 112, 111, 110, 101, 110, 116, 1, 0, 4, 67, 111, 100, 101, 1, 0, 14, 72, 84, 77, 76, 32, 
 99, 111, 110, 116, 97, 105, 110, 101, 114, 1, 0, 19, 91, 76, 106, 97, 118, 97, 47, 108, 97, 110, 
 103, 47, 79, 98, 106, 101, 99, 116, 59, 1, 0, 6, 97, 99, 116, 105, 118, 101, 1, 0, 5, 97, 108, 101, 
 114, 116, 1, 0, 5, 97, 114, 109, 101, 100, 1, 0, 12, 97, 119, 116, 99, 111, 109, 112, 111, 110, 101, 
 110, 116, 1, 0, 4, 98, 117, 115, 121, 1, 0, 6, 99, 97, 110, 118, 97, 115, 1, 0, 9, 99, 104, 101, 99, 
 107, 32, 98, 111, 120, 1, 0, 8, 99, 104, 101, 99, 107, 98, 111, 120, 1, 0, 7, 99, 104, 101, 99, 107, 
 101, 100, 1, 0, 13, 99, 104, 105, 108, 100, 32, 110, 111, 100, 101, 32, 111, 102, 1, 0, 11, 99, 104, 
 105, 108, 100, 78, 111, 100, 101, 79, 102, 1, 0, 9, 99, 111, 108, 108, 97, 112, 115, 101, 100, 1, 0, 
 13, 99, 111, 108, 111, 114, 32, 99, 104, 111, 111, 115, 101, 114, 1, 0, 12, 99, 111, 108, 111, 114, 
 99, 104, 111, 111, 115, 101, 114, 1, 0, 13, 99, 111, 108, 117, 109, 110, 32, 104, 101, 97, 100, 101, 
 114, 1, 0, 12, 99, 111, 108, 117, 109, 110, 104, 101, 97, 100, 101, 114, 1, 0, 54, 99, 111, 109, 47, 
 115, 117, 110, 47, 97, 99, 99, 101, 115, 115, 105, 98, 105, 108, 105, 116, 121, 47, 105, 110, 116, 
 101, 114, 110, 97, 108, 47, 114, 101, 115, 111, 117, 114, 99, 101, 115, 47, 97, 99, 99, 101, 115, 
 115, 105, 98, 105, 108, 105, 116, 121, 1, 0, 9, 99, 111, 109, 98, 111, 32, 98, 111, 120, 1, 0, 8, 
 99, 111, 109, 98, 111, 98, 111, 120, 1, 0, 12, 99, 111, 110, 116, 114, 111, 108, 108, 101, 100, 66, 
 121, 1, 0, 13, 99, 111, 110, 116, 114, 111, 108, 108, 101, 114, 70, 111, 114, 1, 0, 12, 100, 101, 
 115, 107, 116, 111, 112, 32, 105, 99, 111, 110, 1, 0, 12, 100, 101, 115, 107, 116, 111, 112, 32, 
 112, 97, 110, 101, 1, 0, 11, 100, 101, 115, 107, 116, 111, 112, 105, 99, 111, 110, 1, 0, 11, 100, 
 101, 115, 107, 116, 111, 112, 112, 97, 110, 101, 1, 0, 6, 100, 105, 97, 108, 111, 103, 1, 0, 14, 100, 
 105, 114, 101, 99, 116, 111, 114, 121, 32, 112, 97, 110, 101, 1, 0, 13, 100, 105, 114, 101, 99, 116, 
 111, 114, 121, 112, 97, 110, 101, 1, 0, 8, 101, 100, 105, 116, 97, 98, 108, 101, 1, 0, 7, 101, 100, 
 105, 116, 98, 97, 114, 1, 0, 11, 101, 109, 98, 101, 100, 100, 101, 100, 32, 98, 121, 1, 0, 10, 101, 
 109, 98, 101, 100, 100, 101, 100, 66, 121, 1, 0, 6, 101, 109, 98, 101, 100, 115, 1, 0, 7, 101, 110, 
 97, 98, 108, 101, 100, 1, 0, 20, 101, 120, 112, 97, 110, 100, 61, 116, 111, 103, 103, 108, 101, 32, 
 101, 120, 112, 97, 110, 100, 1, 0, 10, 101, 120, 112, 97, 110, 100, 97, 98, 108, 101, 1, 0, 8, 101, 
 120, 112, 97, 110, 100, 101, 100, 1, 0, 12, 102, 105, 108, 101, 32, 99, 104, 111, 111, 115, 101, 114, 
 1, 0, 11, 102, 105, 108, 101, 99, 104, 111, 111, 115, 101, 114, 1, 0, 6, 102, 105, 108, 108, 101, 114, 
 1, 0, 10, 102, 108, 111, 119, 115, 32, 102, 114, 111, 109, 1, 0, 8, 102, 108, 111, 119, 115, 32, 116, 
 111, 1, 0, 9, 102, 108, 111, 119, 115, 70, 114, 111, 109, 1, 0, 7, 102, 108, 111, 119, 115, 84, 111, 
 1, 0, 9, 102, 111, 99, 117, 115, 97, 98, 108, 101, 1, 0, 7, 102, 111, 99, 117, 115, 101, 100, 1, 0, 
 6, 102, 111, 111, 116, 101, 114, 1, 0, 5, 102, 114, 97, 109, 101, 1, 0, 11, 103, 101, 116, 67, 111, 
 110, 116, 101, 110, 116, 115, 1, 0, 10, 103, 108, 97, 115, 115, 32, 112, 97, 110, 101, 1, 0, 9, 103, 
 108, 97, 115, 115, 112, 97, 110, 101, 1, 0, 6, 104, 101, 97, 100, 101, 114, 1, 0, 10, 104, 111, 114, 
 105, 122, 111, 110, 116, 97, 108, 1, 0, 13, 104, 116, 109, 108, 99, 111, 110, 116, 97, 105, 110, 101, 
 114, 1, 0, 9, 105, 99, 111, 110, 105, 102, 105, 101, 100, 1, 0, 13, 105, 110, 100, 101, 116, 101, 114, 
 109, 105, 110, 97, 116, 101, 1, 0, 14, 105, 110, 116, 101, 114, 110, 97, 108, 32, 102, 114, 97, 109, 101, 
 1, 0, 13, 105, 110, 116, 101, 114, 110, 97, 108, 102, 114, 97, 109, 101, 1, 0, 16, 106, 97, 118, 97, 47, 
 108, 97, 110, 103, 47, 79, 98, 106, 101, 99, 116, 1, 0, 28, 106, 97, 118, 97, 47, 117, 116, 105, 108, 
 47, 76, 105, 115, 116, 82, 101, 115, 111, 117, 114, 99, 101, 66, 117, 110, 100, 108, 101, 1, 0, 5, 108, 
 97, 98, 101, 108, 1, 0, 9, 108, 97, 98, 101, 108, 32, 102, 111, 114, 1, 0, 8, 108, 97, 98, 101, 108, 70, 
 111, 114, 1, 0, 10, 108, 97, 98, 101, 108, 101, 100, 32, 98, 121, 1, 0, 9, 108, 97, 98, 101, 108, 101, 
 100, 66, 121, 1, 0, 12, 108, 97, 121, 101, 114, 101, 100, 32, 112, 97, 110, 101, 1, 0, 11, 108, 97, 121, 
 101, 114, 101, 100, 112, 97, 110, 101, 1, 0, 4, 108, 105, 115, 116, 1, 0, 9, 108, 105, 115, 116, 32, 105, 
 116, 101, 109, 1, 0, 8, 108, 105, 115, 116, 105, 116, 101, 109, 1, 0, 19, 109, 97, 110, 97, 103, 101, 115, 
 32, 100, 101, 115, 99, 101, 110, 100, 97, 110, 116, 115, 1, 0, 18, 109, 97, 110, 97, 103, 101, 115, 68, 101, 
 115, 99, 101, 110, 100, 97, 110, 116, 115, 1, 0, 9, 109, 101, 109, 98, 101, 114, 32, 111, 102, 1, 0, 8, 109, 
 101, 109, 98, 101, 114, 79, 102, 1, 0, 4, 109, 101, 110, 117, 1, 0, 8, 109, 101, 110, 117, 32, 98, 97, 114, 
 1, 0, 9, 109, 101, 110, 117, 32, 105, 116, 101, 109, 1, 0, 7, 109, 101, 110, 117, 98, 97, 114, 1, 0, 8, 109, 
 101, 110, 117, 105, 116, 101, 109, 1, 0, 5, 109, 111, 100, 97, 108, 1, 0, 9, 109, 117, 108, 116, 105, 108, 
 105, 110, 101, 1, 0, 13, 109, 117, 108, 116, 105, 112, 108, 101, 32, 108, 105, 110, 101, 1, 0, 15, 109, 117, 
 108, 116, 105, 115, 101, 108, 101, 99, 116, 97, 98, 108, 101, 1, 0, 6, 111, 112, 97, 113, 117, 101, 1, 0, 11, 
 111, 112, 116, 105, 111, 110, 32, 112, 97, 110, 101, 1, 0, 10, 111, 112, 116, 105, 111, 110, 112, 97, 110, 
 101, 1, 0, 8, 112, 97, 103, 101, 32, 116, 97, 98, 1, 0, 13, 112, 97, 103, 101, 32, 116, 97, 98, 32, 108, 105, 
 115, 116, 1, 0, 7, 112, 97, 103, 101, 116, 97, 98, 1, 0, 11, 112, 97, 103, 101, 116, 97, 98, 108, 105, 115, 
 116, 1, 0, 5, 112, 97, 110, 101, 108, 1, 0, 9, 112, 97, 114, 97, 103, 114, 97, 112, 104, 1, 0, 16, 112, 97, 
 114, 101, 110, 116, 32, 119, 105, 110, 100, 111, 119, 32, 111, 102, 1, 0, 14, 112, 97, 114, 101, 110, 116, 87, 
 105, 110, 100, 111, 119, 79, 102, 1, 0, 13, 112, 97, 115, 115, 119, 111, 114, 100, 32, 116, 101, 120, 116, 1, 
 0, 12, 112, 97, 115, 115, 119, 111, 114, 100, 116, 101, 120, 116, 1, 0, 10, 112, 111, 112, 117, 112, 32, 109, 
 101, 110, 117, 1, 0, 9, 112, 111, 112, 117, 112, 109, 101, 110, 117, 1, 0, 7, 112, 114, 101, 115, 115, 101, 
 100, 1, 0, 12, 112, 114, 111, 103, 114, 101, 115, 115, 32, 98, 97, 114, 1, 0, 16, 112, 114, 111, 103, 114, 
 101, 115, 115, 32, 109, 111, 110, 105, 116, 111, 114, 1, 0, 15, 112, 114, 111, 103, 114, 101, 115, 115, 77, 
 111, 110, 105, 116, 111, 114, 1, 0, 11, 112, 114, 111, 103, 114, 101, 115, 115, 98, 97, 114, 1, 0, 11, 112, 
 117, 115, 104, 32, 98, 117, 116, 116, 111, 110, 1, 0, 10, 112, 117, 115, 104, 98, 117, 116, 116, 111, 110, 1, 
 0, 12, 114, 97, 100, 105, 111, 32, 98, 117, 116, 116, 111, 110, 1, 0, 11, 114, 97, 100, 105, 111, 98, 117, 116, 
 116, 111, 110, 1, 0, 9, 114, 101, 115, 105, 122, 97, 98, 108, 101, 1, 0, 9, 114, 111, 111, 116, 32, 112, 97, 
 110, 101, 1, 0, 8, 114, 111, 111, 116, 112, 97, 110, 101, 1, 0, 10, 114, 111, 119, 32, 104, 101, 97, 100, 101, 
 114, 1, 0, 9, 114, 111, 119, 104, 101, 97, 100, 101, 114, 1, 0, 5, 114, 117, 108, 101, 114, 1, 0, 10, 115, 99, 
 114, 111, 108, 108, 32, 98, 97, 114, 1, 0, 11, 115, 99, 114, 111, 108, 108, 32, 112, 97, 110, 101, 1, 0, 9, 115, 
 99, 114, 111, 108, 108, 98, 97, 114, 1, 0, 10, 115, 99, 114, 111, 108, 108, 112, 97, 110, 101, 1, 0, 10, 115, 
 101, 108, 101, 99, 116, 97, 98, 108, 101, 1, 0, 8, 115, 101, 108, 101, 99, 116, 101, 100, 1, 0, 9, 115, 101, 
 112, 97, 114, 97, 116, 111, 114, 1, 0, 7, 115, 104, 111, 119, 105, 110, 103, 1, 0, 11, 115, 105, 110, 103, 108, 
 101, 32, 108, 105, 110, 101, 1, 0, 10, 115, 105, 110, 103, 108, 101, 108, 105, 110, 101, 1, 0, 6, 115, 108, 105, 
 100, 101, 114, 1, 0, 10, 115, 112, 108, 105, 116, 32, 112, 97, 110, 101, 1, 0, 9, 115, 112, 108, 105, 116, 112, 
 97, 110, 101, 1, 0, 12, 115, 117, 98, 119, 105, 110, 100, 111, 119, 32, 111, 102, 1, 0, 11, 115, 117, 98, 119, 
 105, 110, 100, 111, 119, 79, 102, 1, 0, 15, 115, 119, 105, 110, 103, 32, 99, 111, 109, 112, 111, 110, 101, 110, 
 116, 1, 0, 14, 115, 119, 105, 110, 103, 99, 111, 109, 112, 111, 110, 101, 110, 116, 1, 0, 5, 116, 97, 98, 108, 
 101, 1, 0, 4, 116, 101, 120, 116, 1, 0, 6, 116, 111, 103, 103, 108, 101, 1, 0, 13, 116, 111, 103, 103, 108, 101, 
 32, 98, 117, 116, 116, 111, 110, 1, 0, 12, 116, 111, 103, 103, 108, 101, 98, 117, 116, 116, 111, 110, 1, 0, 8, 
 116, 111, 111, 108, 32, 98, 97, 114, 1, 0, 8, 116, 111, 111, 108, 32, 116, 105, 112, 1, 0, 7, 116, 111, 111, 108, 
 98, 97, 114, 1, 0, 7, 116, 111, 111, 108, 116, 105, 112, 1, 0, 9, 116, 114, 97, 110, 115, 105, 101, 110, 116, 1, 
 0, 4, 116, 114, 101, 101, 1, 0, 9, 116, 114, 117, 110, 99, 97, 116, 101, 100, 1, 0, 7, 117, 110, 107, 110, 111, 
 119, 110, 1, 0, 8, 118, 101, 114, 116, 105, 99, 97, 108, 1, 0, 8, 118, 105, 101, 119, 112, 111, 114, 116, 1, 0, 7, 
 118, 105, 115, 105, 98, 108, 101, 1, 0, 6, 119, 105, 110, 100, 111, 119, 7, 0, -105, 7, 0, -88, 7, 0, -46, 7, 0, 
 -45, 1, 0, 22, 40, 41, 91, 91, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 79, 98, 106, 101, 99, 116, 59, 12, 
 0, -109, 0, -110, 10, 1, 46, 1, 48, 0, 49, 1, 44, 1, 46, 0, 0, 0, 0, 0, 2, 0, 1, 0, -109, 0, -110, 0, 1, 0, -107, 
 0, 0, 0, 17, 0, 1, 0, 1, 0, 0, 0, 5, 42, -73, 1, 49, -79, 0, 0, 0, 0, 0, 20, 0, -56, 1, 47, 0, 1, 0, -107, 0, 0, 
 6, -16, 0, 7, 0, 1, 0, 0, 6, -28, 16, 98, -67, 1, 43, 89, 3, 5, -67, 1, 45, 89, 3, 18, 3, 83, 89, 4, 18, 3, 83, 
 83, 89, 4, 5, -67, 1, 45, 89, 3, 18, 4, 83, 89, 4, 18, 4, 83, 83, 89, 5, 5, -67, 1, 45, 89, 3, 18, 5, 83, 89, 4, 
 18, 5, 83, 83, 89, 6, 5, -67, 1, 45, 89, 3, 18, 6, 83, 89, 4, 18, 1, 83, 83, 89, 7, 5, -67, 1, 45, 89, 3, 18, 7, 
 83, 89, 4, 18, 7, 83, 83, 89, 8, 5, -67, 1, 45, 89, 3, 18, 8, 83, 89, 4, 18, 8, 83, 83, 89, 16, 6, 5, -67, 1, 45, 
 89, 3, 18, 10, 83, 89, 4, 18, 9, 83, 83, 89, 16, 7, 5, -67, 1, 45, 89, 3, 18, 11, 83, 89, 4, 18, 11, 83, 83, 89, 
 16, 8, 5, -67, 1, 45, 89, 3, 18, 13, 83, 89, 4, 18, 12, 83, 83, 89, 16, 9, 5, -67, 1, 45, 89, 3, 18, 14, 83, 89, 
 4, 18, 14, 83, 83, 89, 16, 10, 5, -67, 1, 45, 89, 3, 18, 16, 83, 89, 4, 18, 15, 83, 83, 89, 16, 11, 5, -67, 1, 45, 
 89, 3, 18, 18, 83, 89, 4, 18, 17, 83, 83, 89, 16, 12, 5, -67, 1, 45, 89, 3, 18, 20, 83, 89, 4, 18, 19, 83, 83, 89, 
 16, 13, 5, -67, 1, 45, 89, 3, 18, 21, 83, 89, 4, 18, 21, 83, 83, 89, 16, 14, 5, -67, 1, 45, 89, 3, 18, 22, 83, 89, 
 4, 18, 22, 83, 83, 89, 16, 15, 5, -67, 1, 45, 89, 3, 18, 25, 83, 89, 4, 18, 23, 83, 83, 89, 16, 16, 5, -67, 1, 45, 
 89, 3, 18, 26, 83, 89, 4, 18, 24, 83, 83, 89, 16, 17, 5, -67, 1, 45, 89, 3, 18, 27, 83, 89, 4, 18, 27, 83, 83, 89, 
 16, 18, 5, -67, 1, 45, 89, 3, 18, 29, 83, 89, 4, 18, 28, 83, 83, 89, 16, 19, 5, -67, 1, 45, 89, 3, 18, 30, 83, 89, 
 4, 18, 30, 83, 83, 89, 16, 20, 5, -67, 1, 45, 89, 3, 18, 31, 83, 89, 4, 18, 31, 83, 83, 89, 16, 21, 5, -67, 1, 45, 
 89, 3, 18, 33, 83, 89, 4, 18, 32, 83, 83, 89, 16, 22, 5, -67, 1, 45, 89, 3, 18, 34, 83, 89, 4, 18, 34, 83, 83, 89, 
 16, 23, 5, -67, 1, 45, 89, 3, 18, 35, 83, 89, 4, 18, 35, 83, 83, 89, 16, 24, 5, -67, 1, 45, 89, 3, 18, 37, 83, 89, 
 4, 18, 37, 83, 83, 89, 16, 25, 5, -67, 1, 45, 89, 3, 18, 38, 83, 89, 4, 18, 38, 83, 83, 89, 16, 26, 5, -67, 1, 45, 
 89, 3, 18, 40, 83, 89, 4, 18, 39, 83, 83, 89, 16, 27, 5, -67, 1, 45, 89, 3, 18, 41, 83, 89, 4, 18, 41, 83, 83, 89, 
 16, 28, 5, -67, 1, 45, 89, 3, 18, 44, 83, 89, 4, 18, 42, 83, 83, 89, 16, 29, 5, -67, 1, 45, 89, 3, 18, 45, 83, 89, 
 4, 18, 43, 83, 83, 89, 16, 30, 5, -67, 1, 45, 89, 3, 18, 46, 83, 89, 4, 18, 46, 83, 83, 89, 16, 31, 5, -67, 1, 45, 
 89, 3, 18, 47, 83, 89, 4, 18, 47, 83, 83, 89, 16, 32, 5, -67, 1, 45, 89, 3, 18, 48, 83, 89, 4, 18, 48, 83, 83, 89
};
    
    
    public static void main(String[] args)
    {
       System.out.println("TestBWT");

        // Test behavior
        {
            System.out.println("\nCorrectness test");
            int start = 0;
            byte[] buf1 = "mississippi".getBytes();
            int size = buf1.length;
            byte[] buf2 = new byte[size];
            byte[] buf3 = new byte[size];
            BWT bwt = new BWT();

            String str1 = new String(buf1);
            System.out.println("\nInput:   "+new String(buf1));            
            buf2 = bwt.forward(buf1, start);
            int primaryIndex = bwt.getPrimaryIndex();
            System.out.println("Encoded: "+new String(buf2));
            System.out.println("Primary index: "+bwt.getPrimaryIndex());
            bwt.setPrimaryIndex(primaryIndex);
            buf3 = bwt.inverse(buf2, start);
            System.out.println("Output:  "+new String(buf3));

            if (str1.equals(new String(buf3)) == true)
               System.out.println("Identical");
            else
            {
               System.out.println("Different");
               System.exit(1);
            }

        }
        
        // Test behavior
        for (int ii=2; ii<20; ii++)
        {
            System.out.println("\nCorrectness test "+ii);
            int start = 0;
            int size;
            byte[] buf1;
            Random rnd = new Random();

            if (ii == 2)
            {
               buf1 = ARRAY1;
               size = ARRAY1.length;

            byte[] buf2 = new byte[size];
            byte[] buf3 = new byte[size];
            BWT bwt = new BWT(size);

              for (int i=0; i<size; i++)
              {
                  if (i % 200 == 0)
                      System.out.println("");


                  System.out.print(buf1[i]+"@ ");
              }

              String str1 = new String(buf1);
              buf2 = bwt.forward(buf1, start);
              System.out.println("\nPrimary index: "+bwt.getPrimaryIndex());

              buf3 = bwt.inverse(buf2, start);

              for (int i=0; i<size; i++)
              {
                  if (i % 200 == 0)
                      System.out.println("");

                  System.out.print(buf3[i]+"@ ");
              }

              if (str1.equals(new String(buf3)) == true)
                 System.out.println("\nIdentical");
              else
              {
                 System.out.println("\nDifferent");
                 System.exit(1);
              }

              continue;

            }
            else
            {
                size = 128;
                buf1 = new byte[size];

                for (int i=0; i<buf1.length; i++)
                {
                    buf1[i] = (byte) (65 + rnd.nextInt(32));
                }
            }

            buf1[buf1.length-1] = (byte) 0;
            byte[] buf2 = new byte[size];
            byte[] buf3 = new byte[size];
            BWT bwt = new BWT(size);

            String str1 = new String(buf1);
            System.out.println("\nInput:   "+str1);
            buf2 = bwt.forward(buf1, start);
            int primaryIndex = bwt.getPrimaryIndex();
            String str2 = new String(buf2);
            System.out.println("Encoded: "+str2);
            System.out.println("Primary index: "+bwt.getPrimaryIndex());
            bwt.setPrimaryIndex(primaryIndex);
            buf3 = bwt.inverse(buf2, start);
            String str3 = new String(buf3);
            System.out.println("Output:  "+str3);

            if (str1.equals(str3) == true)
               System.out.println("Identical");
            else
            {
               System.out.println("Different");
               System.exit(1);
            }
        }

        
        // Test Speed
        {            
            System.out.println("\nSpeed test");
            int iter = 2000;
            long delta1 = 0;
            long delta2 = 0;

            for (int jj = 0; jj < 20; jj++)
            {
                int size = 8192;
                byte[] buf1 = new byte[size];
                byte[] buf2 = new byte[size];
                byte[] buf3 = new byte[size];
                BWT bwt = new BWT(size);
                java.util.Random random = new java.util.Random();

                for (int i = 0; i < size; i++)
                    buf1[i] = (byte) (random.nextInt() & 64);

                buf1[size-1] = 0;
                long before, after;

                for (int ii = 0; ii < iter; ii++)
                {
                    before = System.nanoTime();
                    buf2 = bwt.forward(buf1, 0);
                    after = System.nanoTime();
                    delta1 += (after - before);
                    before = System.nanoTime();
                    buf3 = bwt.inverse(buf2, 0);
                    after = System.nanoTime();
                    delta2 += (after - before);
                }
            }

            System.out.println("Iterations: "+iter);
            System.out.println("Forward transform [ms]: " + delta1 / 1000000);
            System.out.println("Inverse transform [ms]: " + delta2 / 1000000);
        }
    }
}
